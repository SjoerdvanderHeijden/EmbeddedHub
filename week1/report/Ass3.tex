\documentclass{article}

\usepackage[hidelinks]{hyperref}
\usepackage[utf8]{inputenc}
%\usepackage[latin1]{inputenc}
%\documentclass[15pt,a4paper]{article}
%\usepackage[latin1]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[titletoc,title]{appendix}
\usepackage[english]{babel}
\usepackage[font= small,format=plain,labelfont=bf,up,textfont=it,up]{caption}
\usepackage{colortbl}
\usepackage{diagbox}
\usepackage{eurosym, placeins}
\usepackage{fullpage,graphicx,textcomp,float,gensymb,wrapfig}
\usepackage{longtable}
\usepackage{makecell}
\usepackage{multicol}
\usepackage{mathrsfs}
\usepackage[numbers]{natbib}
\usepackage{parskip}
\usepackage[detect-all]{siunitx}
\usepackage{subcaption}
\usepackage{tabularx}
\newtheorem{theorem}{Theorem}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{wasysym}


\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
\newcommand{\red}[1]{{\color{red}{#1}}}

\usepackage{textcomp} % for a single apostrophe with \textquotesingle

\edef\restoreparindent{\parindent=\the\parindent\relax}
\restoreparindent

\allowdisplaybreaks

\graphicspath{{../}}

\sisetup{range-phrase=--}
\sisetup{range-units=single}

\newcommand{\subfigimg}[3][,]{%
	\setbox1=\hbox{\includegraphics[#1]{#3}}% Store image in box
	\leavevmode\rlap{\usebox1}% Print image
	\rlap{\hspace*{0.9\linewidth}\raisebox{\dimexpr\ht1-1.75\baselineskip}{#2}}% Print label
	\phantom{\usebox1}% Insert appropriate spacing
}



\title{Embedded systems: Assignment 3}
\date{\today}
\author{Sjoerd van der Heijden \\ 10336001}

\begin{document}
	\maketitle
	\tableofcontents
	\pagenumbering{arabic}
	\section{Introduction}
	\par In this document I will show and explain my solutions to the tasks detailed in Assignment 3 of the course Embedded Systems 2018.
	
	\section{Assignment 3.1}
	\par For the first part of this assignment I was tasked to create a Petri net model of a four-way intersection for cars. On this intersection cars are only allowed to drive straight, and they have to give priority to cars on their right. 	Fig.\,\ref{fig:ass3_1} shows my solution for this task, with an example initial token distribution. I use inhibitors to prevent cars from driving as long as there's a car coming from their right, or when a car from the left or right is already on the intersection. Cars from opposite directions may cross the intersection simultaniously.
	\par It is possible for the cars to come into deadlock, when a car from each direction is waiting to cross. I did not solve this, as this is not disallowed by the assignment. In order to solve it, one could add another level of priority, e.g. by adding another event that can be fired when cars are waiting from all directions and no cars are crossing, and results in one or two cars crossing the intersection. In the case of two cars crossing they would have to come from opposite directions to prevent collisions.	
	
	\begin{figure}
		\includegraphics[width=0.5\textwidth]{Ass3_1}
		\caption{My solution to assignment 3.1, this image was created using PIPE 5 \cite{dingle2009pipe2, bonet2007pipe}. The N, E, S and W stand for the cardinal directions. For each direction, a car is first driving towards the intersection (arriving), then reaching the intersection and waiting to cross (waiting), then driving on the intersection (crossing), and finally they leave the intersection (crossed). \label{fig:ass3_1}}
	\end{figure}
	
	\section{Assignment 3.2}
	\par The assignment was to compute $Z = A \times \textrm{min}(B, 2\times C)$ using Petri nets. My solution is shown in Fig.\,\ref{fig:ass3_2}. For the sake of being an example, there are tokens present in the net, so that it shows a possible initial state of the aforementioned equation.
	
	\begin{figure}
		\includegraphics[width=0.5\textwidth]{Ass3_2}
		\caption{My solution to assignment 3.2, this image was created using PIPE 5 \cite{dingle2009pipe2, bonet2007pipe}. \label{fig:ass3_2}}
	\end{figure}
	
	\section{Assignment 3.3}
	\par I made a chessclock library in Simulink (see Fig.\,\ref{fig:ass3_3_env} and Fig.\,\ref{fig:ass3_3_chart}), since it had to be the same for both players. The only downside is that the number of moves taken is now measured twice.
	
	
	\begin{figure}
		\includegraphics[width=0.5\textwidth]{Ass3_3_environment}
		\caption{The outside view of my solution to assignment 3.3: there is one chess clock for each player, the switch tells which player's turn it is, and the lights are green if a player is still playing and red if a player loses.
		This image was created using PIPE 5 \cite{dingle2009pipe2, bonet2007pipe}. \label{fig:ass3_3_env}}
	\end{figure}

	\begin{figure}
		\includegraphics[width=0.5\textwidth]{Ass3_3_chart}
		\caption{A peek under the hood of my chessclock for assignment 3.3. This image was created using PIPE 5 \cite{dingle2009pipe2, bonet2007pipe}. \label{fig:ass3_3_chart}}
	\end{figure}


%
%	\section*{Acknowledgements}
%	I would like to thank the EUV Plasma Dynamics group at ARCNL for hosting the work done for this thesis and for many insightful discussions. I also want to thank the ARCNL group EUV Generation and Imaging for the use of their laser for studying the ps-on-droplet case. Furthermore I want to thank the AMOLF workshop and ARCNL technicians for aid and technical support during the experiments and Mikhail Basko for enlightening communications.
	
	\newpage 

	
	
	\bibliographystyle{unsrtnat}
	%\bibliographystyle{authordate1}
	\bibliography{bibliography} % The file containing the bibliography
%	\newpage
	

%	\begin{figure}[ht!]
%		\hspace{-2mm}\makebox[\textwidth][c]{
%			\begin{tabular}{@{}p{0.5\linewidth}@{\hspace{5mm}}p{0.5\linewidth}@{}}
%				\subfigimg[width = 0.55\textwidth]{\hspace{0mm}(a)}{Offseteffect} &
%				\subfigimg[width = 0.55\textwidth]{\hspace{0mm}(b)}{RCeffect}
%		\end{tabular}}
%		\caption{Energy distribution plots made with different (wrong) offsets to the measured voltage (a) and with different (wrong) values for the capacitance used for correcting the data using Eq.\,(\ref{eq:Ifc}) (b). This is to the end of finding out how a mistake during the process of data-correction influences the data.  \label{fig:effects}}
%	\end{figure}
		
	
\end{document}
